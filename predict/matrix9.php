<?php

# Activation matrix from ADRB2.pepd:
$matrix =
[
	'TMR1' => [ -2.085748,  0.999161,  0.541523,  0.227509,  0.622813,  0.334572,  1.020319,  1.053395, -0.199438 ],
	'TMR2' => [  1.129009,  0.317495, -0.306989,  1.376137,  1.262569,  0.421425,  1.990763,  0.589527,  0.498976 ],
	'TMR3' => [ -0.022306,  2.830248, -0.478422, -0.285741, -0.105700, -0.331291, -1.630260, -2.362781, -2.084338 ],
	'TMR4' => [ -0.949617,  2.118884, -0.106401,  0.182301,  2.177391,  0.158758,  0.695187,  1.876168, -0.352305 ],
	'TMR5' => [ -0.554504,  0.253978, -0.713764, -1.473541, -1.265711, -1.345943, -3.321619, -3.699796, -1.339734 ],
	'TMR6' => [ -5.414645, -3.399852, -2.154630, -0.564584, -2.126548,  0.113892, -0.162964, -4.181125, -0.244171 ],
	'TMR7' => [  0.139565, -2.368010,  0.748168,  0.537907, -0.564832,  0.648575,  0.430551, -1.126985,  2.697166 ],
];

# Directionals from ADRB2.pepd:
$direction =
[
	'TMR1' => [  10.022051, -18.035954, -48.192184,  18.293468,  -6.563872, -46.488014,  30.249519,   3.212018, -42.338882 ],
	'TMR2' => [  23.863880,   4.109870, -34.803097,  19.048141,  -8.853634, -38.454079,   9.423110, -20.245094, -37.687199 ],
	'TMR3' => [  16.247929, -14.622263, -25.379795,  14.914004,  -0.272325, -26.463764,  18.284002,  13.569511, -29.480095 ],
	'TMR4' => [  28.334146,   7.454933, -25.278877,  20.556980,  -3.698730, -21.067917,  11.622748, -11.799073, -14.549479 ],
	'TMR5' => [   3.093179,  -5.986396, -16.854012,   9.162039,   2.714896, -25.431005,  10.142936,  17.616673, -30.523777 ],
	'TMR6' => [  13.629387,  11.070108, -39.650772,   6.404618,  -0.001935, -33.592453,  -4.828063,  -4.697610, -22.311676 ],
	'TMR7' => [  -0.282568, -11.115187, -34.784798,  11.210663,  -4.967570, -40.788719,  20.013737,   9.836916, -48.052422 ],
];

// TMR5 and TMR3 are being pulled too far apart.
// Both helices are descending, i.e. the N-terminus is towards the extracellular region.
$dir53  = 
[
	$direction['TMR5'][0] - $direction['TMR3'][0],
	$direction['TMR5'][1] - $direction['TMR3'][1],
	$direction['TMR5'][2] - $direction['TMR3'][2],
];

$decrease = 0.25;

for ($i=0; $i<2; $i++)
{
	$matrix['TMR5'][$i] -= ($decrease/2) * $dir53[$i];
	$matrix['TMR3'][$i] += ($decrease/2) * $dir53[$i];
}
